<% layout('layouts/boilerplate') %>

<script src="https://api.mapbox.com/mapbox-gl-js/v2.0.0/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v2.0.0/mapbox-gl.css" rel="stylesheet" />

<div id="map" style="width: 100%; height: 500px;" class="container-flex"></div>

<h1>Campground list</h1>
<a href="/campgrounds/new">Add a new campground</a>

<% for( let campground of campgrounds ) { %>
<div class="card mb-3">
  <div class="row">
    <div class="col-md-4">
      <% if (campground.images.length) { %>
      <img src="<%= campground.images[0].url %>" alt="" class="img-fluid">
      <% } else {%>
      <img src="https://res.cloudinary.com/albajara/image/upload/c_scale,w_400/v1609471976/YelpCamp/2998_tb3zjs.jpg" alt="Campground illustration">
      <% } %>
    </div>
    <div class="col-md-8">
      <div class="card-body">
        <h5 class="card-title"> <%= campground.title %> </h5>
        <small class="card-text text-muted mb-5"><%= campground.location %> </small>
        <p class=" card-text"><%= campground.description %> </p>
        <a href="/campgrounds/<%= campground._id %>" class="btn btn-primary">View campground</a>
      </div>
    </div>
  </div>
</div>
<% } %>


<script>
  const mapToken = '<%-process.env.MAPBOX_PB_TOKEN%>';
  const campgrounds = { features: <%- JSON.stringify(campgrounds) %>}

</script>

<script src="/js/clusterMap.js"></script>
